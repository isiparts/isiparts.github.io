{"version":3,"mappings":"ytDASA,MAAeA,EAAA,CACXC,KAAM,IAAM,aACZC,SAAU,IAAMC,GAAA,IAAAC,OAAO,8BAAwBC,IAC/CC,KAAM,KAAO,CACTC,KAAM,KACNC,IAAK,KACLC,MAAO,KACPC,SAAS,EAETC,WAAY,GAEZC,YAAY,EAEZ,UAAMC,GACFC,QAAQC,IAAI,oBAER,IACKC,KAAAT,WAAaU,UACbC,GACLC,SAASC,KAAO,iCAGfJ,KAAAR,UAAYa,EAAOb,GACnBQ,KAAAP,YAAcY,EAAOZ,GAE1BO,KAAKN,SAAU,CACnB,EAEA,mBAAMY,GACFN,KAAKJ,YAAa,EACd,IACA,MAAMW,QAAUC,MAAMC,EAAI,uCAAwC,CAC9DC,YAAa,UACbC,OAAQ,OACRC,QAAS,CACL,eAAgB,oBAEpBC,KAAMC,KAAKC,UAAU,CACjBC,IAAKhB,KAAKL,eAGd,IAACY,EAAEU,GAAI,CACDC,cAAiBX,EAAEY,OACzB,MAAM,IAAIC,MAAMpB,KAAKqB,GAAGH,EAASI,SAAQ,CAGvC,MAAAJ,QAAiBX,EAAEY,OACrBD,GAAelB,KAAAuB,UAAUC,EAAe,CAAEC,IAAKP,EAASI,QAASI,MAAOC,IAC5E3B,KAAK4B,QAAQC,SAAS,mBAAmBX,EAAS5B,KAAKwC,aAClD5B,GACLJ,QAAQI,MAAMA,GACdF,KAAKuB,UAAUC,EAAe,CAAEC,IAAKvB,EAAOwB,MAAOK,GAAY,CAEnE/B,KAAKJ,YAAa","names":["presaleNew","name","template","__vitePreload","import","__VITE_PRELOAD__","data","user","nav","aside","loading","presaleCif","submitting","init","console","log","this","getAuthenticatedUser","error","location","href","render","createPresale","r","fetch","url","credentials","method","headers","body","JSON","stringify","cif","ok","response","json","Error","$t","message","$dispatch","TOAST_TRIGGER","msg","level","ToastSuccess","$router","navigate","pre","ToastError"],"ignoreList":[],"sources":["../../src/components/pages/presales/presale-new/presale-new.ts"],"sourcesContent":["import aside from '@/components/shared/aside/aside';\nimport nav from '@/components/shared/nav/nav';\nimport { ComponentModule, render } from '@/main';\nimport { TOAST_TRIGGER } from '@/models/events';\nimport { ToastError, ToastSuccess } from '@/models/toast';\nimport { User } from '@/models/user';\nimport { url } from '@/services/api.service';\nimport { getAuthenticatedUser } from '@/services/auth.service';\n\nexport default {\n    name: () => 'presaleNew',\n    template: () => import('./presale-new.html?raw'),\n    data: () => ({\n        user: null as User | null,\n        nav: null as string | null,\n        aside: null as string | null,\n        loading: true,\n\n        presaleCif: '',\n\n        submitting: false,\n\n        async init() {\n            console.log('presale-new@init');\n\n            try {\n                this.user = await getAuthenticatedUser();\n            } catch (error) {\n                location.href = '/login?redirect=/potencial/new';\n            }\n\n            this.nav = await render(nav);\n            this.aside = await render(aside);\n\n            this.loading = false;\n        },\n\n        async createPresale() {\n            this.submitting = true;\n            try {\n                const r = await fetch(url('isiWeb/web/v1/empresas/01/presuntos'), {\n                    credentials: 'include',\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        cif: this.presaleCif,\n                    }),\n                });\n                if (!r.ok) {\n                    const response = await r.json();\n                    throw new Error(this.$t(response.message));\n                }\n\n                const response = await r.json();\n                if (response) this.$dispatch(TOAST_TRIGGER, { msg: response.message, level: ToastSuccess });\n                this.$router.navigate(`/potencial/edit/${response.data.pre}`);\n            } catch (error) {\n                console.error(error);\n                this.$dispatch(TOAST_TRIGGER, { msg: error, level: ToastError });\n            }\n            this.submitting = false;\n        },\n    }),\n} as ComponentModule;\n"],"file":"assets/presale-new-hso2XmcW.js"}