{"version":3,"mappings":"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","names":["ReferenceOriginAlbaran","ReferenceOriginAddMaterial","ReferenceOriginEditMaterial","ReferenceOrigins","reference","name","template","__vitePreload","import","__VITE_PRELOAD__","data","origin","modalSearchRefer","marcas","familias","hasSearched","loadingReferences","selectedRefer","currentRefer","currentDesc","currentMarca","currentFamilia","referencias","paginationMetaData","currentPage","pageInfo","sortColumnKey","sortOrder","init","console","log","this","initModalSearchRefer","forEach","field","$watch","length","resetValues","$nextTick","parent","_a","$refs","form","closest","dataset","includes","$dispatch","REFERENCE_INIT","window","addEventListener","REFERENCE_GET","e","detail","refer","REFERENCE_CLEAR","REFERENCE_NOT_FOUND","async","show","_b","searchReferInput","focus","searchRefer","Modal","placement","backdrop","backdropClasses","closable","onHide","onShow","onToggle","id","override","document","PAGE_VISIT","hide","prevPage","nextPage","totalPages","openSearchReferModal","Promise","all","loadMarcas","loadFamilias","selectReferencia","setFormReference","referenceData","priceAndDiscount","ivas","getReferenceData","getPriceAndDiscount","getIvas","Error","$t","REFERENCE_FOUND","error","filter","buildFilter","startsWith","r","fetch","url","credentials","headers","ok","response","json","meta","startEntry","endEntry","Math","min","totalRows","sortReferencias","columnKey","TOAST_TRIGGER","msg","level","ToastError","buildReference","target","value","t","statusText","Number","parseInt","message","WorkOrderTipRepMap","A","G","M","P","C","J","R","T","I","O","EmptyWorkOrderMaterial","OR","artde1","canped","dtvdto","dtvdto2","dtvdto3","implnet","iva","linea","precioCero","pvp1","EmptyWorkOrderIvas","ejr","sef","cont","docum","civa","tiva","treq","impliva","implbas","implreq","workOrderEdit","user","nav","aside","signature","loading","loadingWorkOrderMecs","loadingWorkOrderMaterials","loadingWorkOrderDocs","submitting","workOrder","mecs","userMec","EmptyMec","workOrderMecs","currentWorkOrderMec","workOrderMaterials","currentWorkOrderMaterial","workOrderIvas","adjuntos","currentAdjunto","tabs","text","currentTab","modalSign","clientSignature","mecSignature","modalMecAdd","modalMecDelete","modalMecEdit","modalMaterialAdd","modalMaterialDelete","modalMaterialEdit","modalAdjuntoAdd","modalAdjuntoDelete","modalAdjuntoView","getAuthenticatedUser","location","href","render","loadWorkOrder","loadMecs","loadUserMec","loadWorkOrderDocs","loadWorkOrderMecs","loadWorkOrderMaterials","initModalSign","initModalMecDelete","initModalMecEdit","initModalMecAdd","initModalMaterialAdd","initModalMaterialDelete","initModalMaterialEdit","initModalAdjuntoAdd","initModalAdjuntoDelete","initModalAdjuntoView","SIGNATURE_SAVE","key","SIGNATURE_CLEAR_ALL","_c","$params","or","pvp","_d","_e","_f","PineconeRouter","context","params","status","toString","empresa","usuario","addAdjunto","file","FormData","get","adjunto","reader","FileReader","onload","event","dataURL","result","attachment","numDocum","nombre","fecha","Date","toISOString","split","hora","descripcion","documento","method","body","JSON","stringify","ToastSuccess","readAsDataURL","saveWorkOrderReference","referenceDetails","Object","fromEntries","entries","savedWorkOrder","numser","reparacion","openSignModal","openAddAdjuntoModal","formAttachAdjunto","reset","openViewAdjuntoModal","objectDiv","modalAdjuntoViewImage","newModalAdjunto","children","removeChild","mimeType","createElement","className","src","generateAdjuntoUrl","appendChild","endsWith","width","height","controls","videoSource","adjuntoBlob","type","fallbackContent","hrefFallback","textContent","openDeleteAdjuntoModal","openAddMecModal","formMecAdd","openEditMecModal","workOrderMec","openEditMaterialModal","workOrderMaterial","openAddMaterialModal","openDeleteMecModal","openDeleteMaterialModal","addMec","newMec","intDes","fecint","horDes","mec","kmDes","horTra","facturar","editMec","editedMec","facturarMec","deleteMec","addMaterial","editMaterial","editedMaterial","deleteMaterial","deleteAdjunto","almnro","tipRepValue","tiprep","uri","finalizeWorkOrder","signatures","i","origen","substring","indexOf","$router","navigate"],"ignoreList":[],"sources":["../../src/models/referencia.ts","../../src/components/shared/reference/reference.ts","../../src/models/or.ts","../../src/components/pages/work-orders/work-order-edit/work-order-edit.ts"],"sourcesContent":["export interface Referencia {\n    refer: string; // identifier\n    artde1: string;\n    catal: string;\n    codbar: string;\n    mar: string;\n    fap: string;\n    fam: string;\n    unven: number;\n    uniem: number;\n    unmin: number;\n    dimlargo: number;\n    dimalto: number;\n    dimancho: number;\n    peso: number;\n    volumen: number;\n    fecal: Date;\n    fecbaj: Date;\n    baja: string;\n    obsoleto: boolean;\n}\n\nexport const ReferenceOriginAlbaran: ReferenceOrigin = 'albaran';\nexport const ReferenceOriginAddMaterial: ReferenceOrigin = 'add-material';\nexport const ReferenceOriginEditMaterial: ReferenceOrigin = 'edit-material';\n\nexport type ReferenceOrigin = 'albaran' | 'add-material' | 'edit-material';\n\nexport const ReferenceOrigins: ReferenceOrigin[] = [\n    ReferenceOriginAlbaran,\n    ReferenceOriginAddMaterial,\n    ReferenceOriginEditMaterial,\n];\n\nexport interface Marca {\n    mar: string;\n    mardes: string;\n}\n\nexport interface Familia {\n    fap: string;\n    fapdes: string;\n}\n","import { ComponentModule } from '@/main';\nimport {\n    PAGE_VISIT,\n    REFERENCE_CLEAR,\n    REFERENCE_FOUND,\n    REFERENCE_GET,\n    REFERENCE_INIT,\n    REFERENCE_NOT_FOUND,\n    TOAST_TRIGGER,\n} from '@/models/events';\nimport { Iva } from '@/models/iva';\nimport { PaginationMetaData } from '@/models/paginacion';\nimport { Precio } from '@/models/precio';\nimport { Familia, Marca, ReferenceOrigin, ReferenceOrigins, Referencia } from '@/models/referencia';\nimport { ToastError } from '@/models/toast';\nimport { url } from '@/services/api.service';\nimport { t } from '@/services/locale.service';\nimport { Modal } from 'flowbite';\n\nconst MIN_SEARCH_LENGTH = 2;\n\nexport default {\n    name: () => 'reference',\n    template: () => import('./reference.html?raw'),\n    data: () => ({\n        reference: '',\n        origin: null as ReferenceOrigin | null,\n\n        // refer modal búsqueda\n        modalSearchRefer: null as Modal | null,\n\n        // datos selects modal búsqueda\n        marcas: [] as Marca[],\n        familias: [] as Familia[],\n\n        // estados de modal búsqueda\n        hasSearched: false,\n        loadingReferences: false,\n\n        // referencia seleccionada modal búsqueda\n        selectedRefer: null as Referencia | null,\n\n        // filtros modal búsqueda\n        currentRefer: '',\n        currentDesc: '',\n        currentMarca: '',\n        currentFamilia: '',\n\n        // resultado referencias modal búsqueda\n        referencias: [] as Referencia[],\n        paginationMetaData: null as PaginationMetaData | null,\n\n        // paginación modal búsqueda\n        currentPage: 1,\n        pageInfo: '',\n\n        // ordenación modal búsqueda\n        sortColumnKey: '',\n        sortOrder: 'asc',\n\n        init() {\n            console.log('reference@init');\n\n            this.initModalSearchRefer();\n\n            const watchFields = ['currentRefer', 'currentDesc', 'currentMarca', 'currentFamilia'];\n            watchFields.forEach((field) => {\n                this.$watch(field, () => {\n                    if (!this.hasSearched) {\n                        this.hasSearched = true;\n                    }\n                    if (this.currentPage !== 1) {\n                        this.currentPage = 1;\n                    }\n                    if (\n                        this.currentRefer.length < MIN_SEARCH_LENGTH &&\n                        this.currentDesc.length < MIN_SEARCH_LENGTH &&\n                        this.currentMarca === '' &&\n                        this.currentFamilia === ''\n                    ) {\n                        this.resetValues();\n                    }\n                });\n            });\n\n            this.$nextTick(() => {\n                console.log('101-reference@nextTick');\n\n                const parent = this.$refs.form?.closest('[data-origin]') as HTMLElement | null;\n                console.log('1-parent', parent);\n                console.log('2-origin', parent?.dataset.origin);\n\n                console.log(\n                    '3-condicion',\n                    // @ts-expect-error 2345\n                    parent?.dataset.origin !== undefined && ReferenceOrigins.includes(parent?.dataset.origin),\n                );\n\n                // @ts-expect-error 2345\n                if (parent?.dataset.origin !== undefined && ReferenceOrigins.includes(parent?.dataset.origin)) {\n                    this.origin = parent.dataset.origin as ReferenceOrigin;\n                }\n\n                this.$dispatch(REFERENCE_INIT, { origin: this.origin as ReferenceOrigin });\n            });\n\n            // @ts-expect-error 2769\n            window.addEventListener(REFERENCE_GET, (e: CustomEvent) => {\n                console.log('99-reference@get', e.detail);\n                console.log('99-origin', this.origin);\n\n                if (e.detail.origin === this.origin) {\n                    //console.log('reference@get', e.detail);\n                    //console.log('origin' ,this.origin);\n\n                    this.reference = e.detail.refer;\n                }\n            });\n\n            // @ts-expect-error 2769\n            window.addEventListener(REFERENCE_CLEAR, (e: CustomEvent) => {\n                console.log('reference@clear', e.detail);\n                this.reference = '';\n            });\n\n            // @ts-expect-error 2769\n            window.addEventListener(REFERENCE_NOT_FOUND, async (e: CustomEvent) => {\n                console.log('reference@not-found', e.detail);\n                if (e.detail.origin === this.origin) {\n                    this.currentRefer = e.detail.reference;\n                    this.modalSearchRefer?.show();\n                    this.$refs.searchReferInput?.focus();\n                    await this.searchRefer();\n                }\n            });\n        },\n\n        initModalSearchRefer() {\n            this.modalSearchRefer = new Modal(\n                this.$refs.modalSearchRefer,\n                {\n                    placement: 'center',\n                    backdrop: 'static', // Prevent closing the reference search modal when clicking outside\n                    backdropClasses: 'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',\n                    closable: true,\n                    onHide: () => {\n                        console.log('modal is hidden');\n                        this.resetValues();\n                        // Reiniciamos los valores de los campos de búsqueda al cerrar el modal\n                        [this.currentRefer, this.currentDesc, this.currentMarca, this.currentFamilia] = [\n                            '',\n                            '',\n                            '',\n                            '',\n                        ];\n                    },\n                    onShow: () => {\n                        console.log('modal is shown');\n                    },\n                    onToggle: () => {\n                        console.log('modal has been toggled');\n                    },\n                },\n                {\n                    id: 'modal-search-refer',\n                    override: true,\n                },\n            );\n\n            document.addEventListener(PAGE_VISIT, () => {\n                console.log('reference@page-visit');\n                this.modalSearchRefer?.hide();\n            });\n        },\n\n        async prevPage() {\n            if (this.currentPage > 1) {\n                this.currentPage--;\n                this.selectedRefer = null;\n                await this.searchRefer();\n            }\n        },\n\n        async nextPage() {\n            if (this.currentPage < this.paginationMetaData?.totalPages) {\n                this.currentPage++;\n                this.selectedRefer = null;\n                await this.searchRefer();\n            }\n        },\n\n        async openSearchReferModal() {\n            await Promise.all([this.loadMarcas(), this.loadFamilias()]);\n            this.modalSearchRefer?.show();\n        },\n\n        selectReferencia(reference: Referencia) {\n            this.selectedRefer = reference;\n        },\n\n        async setFormReference() {\n            if (this.selectedRefer !== null) {\n                try {\n                    const [referenceData, priceAndDiscount, ivas] = await Promise.all([\n                        this.getReferenceData(this.selectedRefer.refer),\n                        this.getPriceAndDiscount(this.selectedRefer.refer),\n                        this.getIvas(this.selectedRefer.refer),\n                    ]);\n\n                    if (!referenceData) {\n                        throw new Error(this.$t('REFERENCE.not_found'));\n                    }\n                    this.$dispatch(REFERENCE_FOUND, {\n                        referenceData,\n                        priceAndDiscount,\n                        ivas,\n                        origin: this.origin as ReferenceOrigin,\n                    });\n                    this.reference = this.selectedRefer.refer;\n                    this.modalSearchRefer?.hide();\n                } catch (error: any) {\n                    console.log('error', error);\n                }\n            }\n        },\n\n        async searchRefer() {\n            const filter = `${this.buildFilter()}&page=${this.currentPage}&pageSize=10&sort=${this.sortColumnKey}&order=${this.sortOrder}`;\n\n            try {\n                if (!filter.startsWith('&page')) {\n                    this.loadingReferences = true;\n                    const r = await fetch(url(`/isiWeb/web/v1/empresas/01/referencias?${filter}`), {\n                        credentials: 'include',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                    });\n\n                    if (!r.ok) {\n                        throw new Error(this.$t('Error al buscar referencias'));\n                    }\n                    const response = await r.json();\n\n                    this.referencias = response.data as Referencia[];\n                    this.paginationMetaData = response.meta as PaginationMetaData;\n\n                    const startEntry = (this.currentPage - 1) * 10 + 1;\n                    const endEntry = Math.min(this.currentPage * 10, this.paginationMetaData.totalRows);\n                    this.pageInfo = `Mostrando ${startEntry} a ${endEntry} de ${this.paginationMetaData.totalRows} registros`;\n                    this.loadingReferences = false;\n                }\n            } catch (error: any) {\n                console.log('error', error);\n                this.resetValues();\n                this.loadingReferences = false;\n            }\n        },\n\n        async sortReferencias(columnKey: string) {\n            this.currentPage = 1;\n            this.sortColumnKey = columnKey;\n            this.sortOrder = this.sortOrder === 'asc' ? 'desc' : 'asc';\n            await this.searchRefer();\n        },\n\n        resetValues() {\n            this.pageInfo = '';\n            this.referencias = [];\n            this.paginationMetaData = null;\n            this.hasSearched = false;\n            this.loadingReferences = false;\n            this.selectedRefer = null;\n        },\n\n        buildFilter(): string {\n            let filter = '';\n\n            if (this.currentRefer.length >= MIN_SEARCH_LENGTH) {\n                filter += `refer:like=${this.currentRefer}`;\n            }\n            if (this.currentDesc.length >= MIN_SEARCH_LENGTH) {\n                if (filter !== '') {\n                    filter += `&artde1:like=${this.currentDesc}`;\n                } else {\n                    filter += `artde1:like=${this.currentDesc}`;\n                }\n            }\n            if (this.currentMarca !== '') {\n                if (filter !== '') {\n                    filter += `&mar:like=${this.currentMarca}`;\n                } else {\n                    filter += `mar:like=${this.currentMarca}`;\n                }\n            }\n            if (this.currentFamilia !== '') {\n                if (filter !== '') {\n                    filter += `&fap:like=${this.currentFamilia}`;\n                } else {\n                    filter += `fap:like=${this.currentFamilia}`;\n                }\n            }\n\n            return filter;\n        },\n\n        async loadMarcas() {\n            try {\n                const r = await fetch(url('/isiWeb/web/v1/empresas/01/marcas'), {\n                    credentials: 'include',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                });\n\n                if (!r.ok) {\n                    throw new Error(this.$t('Error al cargar marcas'));\n                }\n\n                const response = await r.json();\n\n                this.marcas = response.data as Marca[];\n            } catch (error: any) {\n                console.log('error', error);\n                this.$dispatch(TOAST_TRIGGER, { msg: error, level: ToastError });\n            }\n        },\n\n        async loadFamilias() {\n            try {\n                const r = await fetch(url('/isiWeb/web/v1/empresas/01/familias'), {\n                    credentials: 'include',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                });\n\n                if (!r.ok) {\n                    throw new Error(this.$t('Error al cargar familias'));\n                }\n\n                const response = await r.json();\n\n                this.familias = response.data as Familia[];\n            } catch (error: any) {\n                console.log('error', error);\n                this.$dispatch(TOAST_TRIGGER, { msg: error, level: ToastError });\n            }\n        },\n\n        async buildReference(e: Event) {\n            const reference = (e.target as HTMLInputElement).value;\n\n            try {\n                if (reference !== '') {\n                    const [referenceData, priceAndDiscount, ivas] = await Promise.all([\n                        this.getReferenceData(reference),\n                        this.getPriceAndDiscount(reference),\n                        this.getIvas(reference),\n                    ]);\n\n                    if (!referenceData) {\n                        this.$dispatch(REFERENCE_NOT_FOUND, { reference, origin: this.origin as ReferenceOrigin });\n                        return;\n                    }\n\n                    this.$dispatch(REFERENCE_FOUND, {\n                        referenceData,\n                        priceAndDiscount,\n                        ivas,\n                        origin: this.origin as ReferenceOrigin,\n                    });\n                }\n            } catch (error: any) {\n                console.log('error', error);\n            }\n        },\n\n        async getReferenceData(reference: string) {\n            try {\n                const r = await fetch(url(`/isiWeb/web/v1/empresas/01/referencias/${reference}`), {\n                    credentials: 'include',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                });\n\n                if (!r.ok) {\n                    throw new Error(t(r.statusText));\n                }\n\n                const referenceData = await r.json();\n\n                return referenceData as Referencia;\n            } catch (error: any) {\n                console.log('error', error);\n                if (Number.parseInt(error.message) !== 404) {\n                    this.$dispatch(TOAST_TRIGGER, { msg: 'Error al cargar datos de referencia', level: ToastError });\n                }\n            }\n        },\n\n        async getPriceAndDiscount(reference: string) {\n            try {\n                const r = await fetch(url(`/isiWeb/web/v1/empresas/01/referencias/${reference}/precio`), {\n                    credentials: 'include',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                });\n\n                if (!r.ok) {\n                    throw new Error(t(r.statusText));\n                }\n\n                const response = await r.json();\n\n                return response as Precio;\n            } catch (error: any) {\n                console.log('error', error);\n                if (Number.parseInt(error.message) !== 404) {\n                    this.$dispatch(TOAST_TRIGGER, { msg: 'Error al cargar datos de precios', level: ToastError });\n                }\n            }\n        },\n\n        async getIvas(reference: string) {\n            try {\n                const r = await fetch(url(`/isiWeb/web/v1/empresas/01/referencias/${reference}/iva`), {\n                    credentials: 'include',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                });\n\n                if (!r.ok) {\n                    throw new Error(t(r.statusText));\n                }\n\n                const response = await r.json();\n\n                return response as Iva;\n            } catch (error: any) {\n                console.log('error', error);\n                if (Number.parseInt(error.message) !== 404) {\n                    this.$dispatch(TOAST_TRIGGER, { msg: 'Error al cargar datos de IVA', level: ToastError });\n                }\n            }\n        },\n    }),\n} as ComponentModule;\n","export interface WorkOrder {\n    OR: string; // identifier\n    ejr: number;\n    sef: string;\n    cont: string;\n    docum: number;\n    fedoc: string;\n    almnro: string;\n    cli: number;\n    nroenv: number;\n    cif: string;\n    nom: string;\n    raz: string;\n    pju: string;\n    dir: string;\n    codpos: string;\n    pro: string;\n    prodes: string;\n    pob: string;\n    pobdes: string;\n    tel: string;\n    email: string;\n    tiprep: WorkOrderTipRep;\n    maquina: string;\n    refer: string;\n    numser: string;\n    presupuesto: boolean;\n    mec: number;\n    prioridad: number;\n    fecace: string | null;\n    fecprev: string | null;\n    fecrep: string | null;\n    sintoma: string;\n    reparacion: string;\n    km: number;\n    tcl: string;\n    acti: string;\n    pgm: string;\n    pgd: string;\n    dpp: string;\n    rfi: string;\n    perfac: number;\n    ivc: boolean;\n    iva: string;\n    req: boolean;\n    div: string;\n    tar: string;\n    com: string;\n    por: string;\n    totcemb: number;\n    totcpor: number;\n    totimp: number;\n    totlbru: number;\n    totldto: number;\n    totlnet: number;\n    totcdpp: number;\n    totcrfi: number;\n    totcbas: number;\n    totciva: number;\n}\n\n/**\n * Based on WorkOrder.tiprep value\n *\n * A: Avería\n * G: Garantía\n * M: Mantenimiento\n * P: Pre-montaje\n * C: Reconstrucción\n * J: Montaje\n * R: Reparación\n * T: Taller\n * I: Instalación\n * O: Otros\n */\nexport type WorkOrderTipRep = 'A' | 'G' | 'M' | 'P' | 'C' | 'J' | 'R' | 'T' | 'I' | 'O';\n\n// TODO: use translation service\nexport const WorkOrderTipRepMap: { [K in WorkOrderTipRep]: string } = {\n    A: 'Avería',\n    G: 'Garantía',\n    M: 'Mantenimiento',\n    P: 'Pre-montaje',\n    C: 'Reconstrucción',\n    J: 'Montaje',\n    R: 'Reparación',\n    T: 'Taller',\n    I: 'Instalación',\n    O: 'Otros',\n};\n\nexport interface WorkOrderMec {\n    OR: string;\n    ejr: number;\n    sef: string;\n    cont: string;\n    docum: number;\n    linea: number; // identifier\n    mec: number;\n    mecnom: string;\n    kmDes: number;\n    horDes: number;\n    horTra: number;\n    impgas: number;\n    prehortra: number;\n    dtvdto: number;\n    fecInt: string;\n    intdes: string;\n    fecint: string;\n    facturar: boolean;\n}\n\nexport interface WorkOrderMecPayload {\n    OR: string;\n    intDes: string;\n    fecint: string;\n    horDes: number;\n    mec: number;\n    kmDes: number;\n    horTra: number;\n}\n\nexport interface WorkOrderMaterial {\n    OR: string;\n    artde1: string;\n    canped: number;\n    dtvdto: number;\n    dtvdto2: number;\n    dtvdto3: number;\n    implnet: number;\n    iva: string;\n    linea: number; // identifier\n    precioCero: false;\n    pvp1: number;\n    refer: string;\n}\n\nexport const EmptyWorkOrderMaterial: WorkOrderMaterial = {\n    OR: '',\n    artde1: '',\n    canped: 0,\n    dtvdto: 0,\n    dtvdto2: 0,\n    dtvdto3: 0,\n    implnet: 0,\n    iva: '',\n    linea: -1,\n    precioCero: false,\n    pvp1: 0,\n    refer: '',\n};\n\nexport interface WorkOrderIvas {\n    OR: string;\n    ejr: number;\n    sef: string;\n    cont: string;\n    docum: number;\n    civa: string;\n    tiva: number;\n    treq: number;\n    impliva: number;\n    implbas: number;\n    implreq: number;\n}\n\nexport const EmptyWorkOrderIvas: WorkOrderIvas = {\n    OR: '',\n    ejr: 0,\n    sef: '',\n    cont: '',\n    docum: 0,\n    civa: '',\n    tiva: 0,\n    treq: 0,\n    impliva: 0,\n    implbas: 0,\n    implreq: 0,\n};\n","import aside from '@/components/shared/aside/aside';\nimport nav from '@/components/shared/nav/nav';\nimport reference from '@/components/shared/reference/reference';\nimport signature from '@/components/shared/signature/signature';\n\nimport { ComponentModule, render } from '@/main';\nimport { Adjunto } from '@/models/adjunto';\nimport {\n    PAGE_VISIT,\n    REFERENCE_CLEAR,\n    REFERENCE_FOUND,\n    REFERENCE_GET,\n    REFERENCE_INIT,\n    SIGNATURE_CLEAR_ALL,\n    SIGNATURE_SAVE,\n    TOAST_TRIGGER,\n} from '@/models/events';\nimport { EmptyMec, Mec } from '@/models/mec';\nimport {\n    EmptyWorkOrderIvas,\n    EmptyWorkOrderMaterial,\n    WorkOrder,\n    WorkOrderIvas,\n    WorkOrderMaterial,\n    WorkOrderMec,\n    WorkOrderMecPayload,\n    WorkOrderTipRepMap,\n} from '@/models/or';\nimport {\n    ReferenceOrigin,\n    ReferenceOriginAddMaterial,\n    ReferenceOriginAlbaran,\n    ReferenceOriginEditMaterial,\n} from '@/models/referencia';\nimport { ToastError, ToastSuccess } from '@/models/toast';\nimport { User } from '@/models/user';\nimport { url } from '@/services/api.service';\nimport { getAuthenticatedUser } from '@/services/auth.service';\nimport { Modal } from 'flowbite';\n\nexport default {\n    name: () => 'workOrder',\n    template: () => import('./work-order-edit.html?raw'),\n    data: () => ({\n        // Generic properties\n        error: null as string | null,\n        user: null as User | null,\n\n        // x-html components\n        nav: null as string | null,\n        aside: null as string | null,\n        signature: null as string | null,\n        reference: null as string | null,\n\n        // loading states\n        loading: true,\n        loadingWorkOrderMecs: false,\n        loadingWorkOrderMaterials: false,\n        loadingWorkOrderDocs: false,\n\n        // form states\n        submitting: false,\n\n        // work order generic\n        workOrder: null as WorkOrder | null,\n        mecs: [] as Mec[],\n        userMec: EmptyMec,\n\n        // work order mec\n        workOrderMecs: [] as WorkOrderMec[],\n        currentWorkOrderMec: null as WorkOrderMec | null,\n\n        // work order material\n        workOrderMaterials: [] as WorkOrderMaterial[],\n        currentWorkOrderMaterial: EmptyWorkOrderMaterial,\n        //workOrderMaterial: EmptyWorkOrderMaterial,\n\n        // work order ivas\n        workOrderIvas: EmptyWorkOrderIvas,\n\n        // crud imagenes\n        adjuntos: [] as Adjunto[],\n        currentAdjunto: null as Adjunto | null,\n\n        // Tabs\n        tabs: [\n            { id: 0, text: 'Albarán de reparación' }, // TODO: use translation service\n            { id: 1, text: 'Mano de obra' }, // TODO: use translation service\n            { id: 2, text: 'Material' }, // TODO: use translation service\n            { id: 3, text: 'Adjuntos' }, // TODO: use translation service\n        ],\n        currentTab: 0,\n\n        // Signatures + modal\n        modalSign: null as Modal | null,\n        clientSignature: null as string | null,\n        mecSignature: null as string | null,\n\n        // WorkOrderMec modals\n        modalMecAdd: null as Modal | null,\n        modalMecDelete: null as Modal | null,\n        modalMecEdit: null as Modal | null,\n\n        // Material modals\n        modalMaterialAdd: null as Modal | null,\n        modalMaterialDelete: null as Modal | null,\n        modalMaterialEdit: null as Modal | null,\n\n        // Adjunto modals\n        modalAdjuntoAdd: null as Modal | null,\n        modalAdjuntoDelete: null as Modal | null,\n        modalAdjuntoView: null as Modal | null,\n\n        async init() {\n            console.log('work-order@init');\n\n            try {\n                this.user = await getAuthenticatedUser();\n            } catch (error) {\n                location.href = '/login';\n            }\n\n            this.nav = await render(nav);\n            this.aside = await render(aside);\n            this.signature = await render(signature);\n            this.reference = await render(reference);\n\n            await Promise.all([this.loadWorkOrder(), this.loadMecs(), this.loadUserMec(), this.loadWorkOrderDocs()]);\n\n            this.$watch('currentTab', () => {\n                if (this.currentTab === 0) {\n                    console.log('reference_get', this.workOrder?.refer);\n\n                    this.$dispatch(REFERENCE_GET, {\n                        refer: this.workOrder?.refer,\n                        origin: 'albaran' as ReferenceOrigin,\n                    });\n                }\n                if (this.currentTab === 1) {\n                    this.loadWorkOrderMecs();\n                }\n\n                if (this.currentTab === 2) {\n                    this.loadWorkOrderMaterials();\n                }\n\n                if (this.currentTab === 3) {\n                    this.loadWorkOrderDocs();\n                }\n            });\n\n            this.initModalSign();\n\n            this.initModalMecDelete();\n            this.initModalMecEdit();\n            this.initModalMecAdd();\n\n            this.initModalMaterialAdd();\n            this.initModalMaterialDelete();\n            this.initModalMaterialEdit();\n\n            this.initModalAdjuntoAdd();\n            this.initModalAdjuntoDelete();\n            this.initModalAdjuntoView();\n\n            this.$nextTick(() => {\n                console.log('101-work-order-edit@nextTick');\n\n                // @ts-expect-error 2769\n                window.addEventListener(SIGNATURE_SAVE, (e: CustomEvent) => {\n                    const key: 'client' | 'mec' = e.detail?.key as 'client' | 'mec';\n\n                    if (key === 'client') {\n                        this.clientSignature = e.detail.value;\n                    }\n\n                    if (key === 'mec') {\n                        this.mecSignature = e.detail.value;\n                    }\n                });\n\n                // @ts-expect-error 2769\n                window.addEventListener(SIGNATURE_CLEAR_ALL, (e: CustomEvent) => {\n                    this.clientSignature = null;\n                    this.mecSignature = null;\n                });\n\n                // @ts-expect-error 2769\n                window.addEventListener(REFERENCE_FOUND, (e: CustomEvent) => {\n                    console.log('REFERENCE_FOUND', e.detail);\n\n                    if (e.detail.origin === ReferenceOriginAddMaterial) {\n                        const referenceData = e.detail.referenceData?.data;\n                        const priceAndDiscount = e.detail.priceAndDiscount?.data;\n                        const ivas = e.detail.ivas?.data;\n                        this.currentWorkOrderMaterial = {\n                            OR: this.$params.or,\n                            artde1: referenceData.artde1,\n                            canped: 1,\n                            dtvdto: priceAndDiscount.dtvdto | 0,\n                            dtvdto2: priceAndDiscount.dtvdto2 | 0,\n                            dtvdto3: priceAndDiscount.dtvdto3 | 0,\n                            implnet: priceAndDiscount.pvp,\n                            iva: ivas.iva,\n                            precioCero: false,\n                            pvp1: priceAndDiscount.pvp,\n                            refer: referenceData.refer,\n                        } as WorkOrderMaterial;\n                    }\n\n                    if (e.detail.origin === ReferenceOriginEditMaterial) {\n                        const referenceData = e.detail.referenceData?.data;\n                        const priceAndDiscount = e.detail.priceAndDiscount?.data;\n                        const ivas = e.detail.ivas?.data;\n                        this.currentWorkOrderMaterial = {\n                            ...this.currentWorkOrderMaterial,\n                            artde1: referenceData.artde1,\n                            iva: ivas.iva,\n                            pvp1: priceAndDiscount.pvp,\n                            implnet: priceAndDiscount.pvp,\n                            dtvdto: priceAndDiscount.dtvdto | 0,\n                            dtvdto2: priceAndDiscount.dtvdto2 | 0,\n                            dtvdto3: priceAndDiscount.dtvdto3 | 0,\n                        } as WorkOrderMaterial;\n                    }\n                });\n\n                // @ts-expect-error 2769\n                window.addEventListener(REFERENCE_INIT, (e: CustomEvent) => {\n                    if (e.detail?.origin === ReferenceOriginAlbaran) {\n                        this.$dispatch(REFERENCE_GET, {\n                            refer: this.workOrder?.refer,\n                            origin: ReferenceOriginAlbaran,\n                        });\n                    }\n                });\n            });\n\n            this.loading = false;\n        },\n\n        initModalSign() {\n            this.modalSign = new Modal(\n                this.$refs.modalSign,\n                {\n                    placement: 'center',\n                    backdrop: 'static', // Prevent closing the signature modal when clicking outside\n                    backdropClasses: 'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',\n                    closable: true,\n                    onHide: () => {\n                        // Clear all signatures when modal is closed\n                        this.$dispatch(SIGNATURE_CLEAR_ALL);\n                    },\n                    onShow: () => {\n                        console.log('modal is shown');\n                    },\n                    onToggle: () => {\n                        console.log('modal has been toggled');\n                    },\n                },\n                {\n                    id: `modal-sign-${this.workOrder?.OR}`,\n                    override: true,\n                },\n            );\n\n            document.addEventListener(PAGE_VISIT, () => {\n                console.log('modalSign@page-visit');\n                this.modalSign?.hide();\n            });\n        },\n\n        initModalMecDelete() {\n            this.modalMecDelete = new Modal(\n                this.$refs.modalMecDelete,\n                {\n                    placement: 'center',\n                    backdrop: 'dynamic',\n                    backdropClasses: 'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',\n                    closable: true,\n                    onHide: () => {\n                        console.log('modal is hidden');\n                    },\n                    onShow: () => {\n                        console.log('modal is shown');\n                    },\n                    onToggle: () => {\n                        console.log('modal has been toggled');\n                    },\n                },\n                {\n                    id: `modal-mec-delete-${this.workOrder?.OR}`,\n                    override: true,\n                },\n            );\n\n            document.addEventListener(PAGE_VISIT, () => {\n                console.log('modalMaterialDelete@page-visit');\n                this.modalMaterialDelete?.hide();\n            });\n        },\n\n        initModalMecEdit() {\n            this.modalMecEdit = new Modal(\n                this.$refs.modalMecEdit,\n                {\n                    placement: 'center',\n                    backdrop: 'dynamic',\n                    backdropClasses: 'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',\n                    closable: true,\n                    onHide: () => {\n                        console.log('modal is hidden');\n                    },\n                    onShow: () => {\n                        console.log('modal is shown');\n                    },\n                    onToggle: () => {\n                        console.log('modal has been toggled');\n                    },\n                },\n                {\n                    id: `modal-mec-edit-${this.workOrder?.OR}`,\n                    override: true,\n                },\n            );\n\n            document.addEventListener(PAGE_VISIT, () => {\n                console.log('modalMecEdit@page-visit');\n                this.modalMecEdit?.hide();\n            });\n        },\n\n        initModalMecAdd() {\n            this.modalMecAdd = new Modal(\n                this.$refs.modalMecAdd,\n                {\n                    placement: 'center',\n                    backdrop: 'dynamic',\n                    backdropClasses: 'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',\n                    closable: true,\n                    onHide: () => {\n                        console.log('modal is hidden');\n                    },\n                    onShow: () => {\n                        console.log('modal is shown');\n                    },\n                    onToggle: () => {\n                        console.log('modal has been toggled');\n                    },\n                },\n                {\n                    id: `modal-mec-add-${this.workOrder?.OR}`,\n                    override: true,\n                },\n            );\n\n            document.addEventListener(PAGE_VISIT, () => {\n                console.log('modalMecAdd@page-visit');\n                this.modalMecAdd?.hide();\n            });\n        },\n\n        initModalAdjuntoDelete() {\n            this.modalAdjuntoDelete = new Modal(\n                this.$refs.modalAdjuntoDelete,\n                {\n                    placement: 'center',\n                    backdrop: 'dynamic',\n                    backdropClasses: 'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',\n                    closable: true,\n                    onHide: () => {\n                        console.log('modal is hidden');\n                    },\n                    onShow: () => {\n                        console.log('modal is shown');\n                    },\n                    onToggle: () => {\n                        console.log('modal has been toggled');\n                    },\n                },\n                {\n                    id: `modal-adjunto-delete-${this.workOrder?.OR}`,\n                    override: true,\n                },\n            );\n\n            document.addEventListener(PAGE_VISIT, () => {\n                console.log('modalAdjuntoDelete@page-visit');\n                this.modalAdjuntoDelete?.hide();\n            });\n        },\n\n        initModalAdjuntoAdd() {\n            this.modalAdjuntoAdd = new Modal(\n                this.$refs.modalAdjuntoAdd,\n                {\n                    placement: 'center',\n                    backdrop: 'dynamic',\n                    backdropClasses: 'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',\n                    closable: true,\n                    onHide: () => {\n                        console.log('modal is hidden');\n                    },\n                    onShow: () => {\n                        console.log('modal is shown');\n                    },\n                    onToggle: () => {\n                        console.log('modal has been toggled');\n                    },\n                },\n                {\n                    id: `modal-adjunto-add-${this.workOrder?.OR}`,\n                    override: true,\n                },\n            );\n\n            document.addEventListener(PAGE_VISIT, () => {\n                console.log('modalAdjuntoAdd@page-visit');\n                this.modalAdjuntoAdd?.hide();\n            });\n        },\n\n        initModalAdjuntoView() {\n            this.modalAdjuntoView = new Modal(\n                this.$refs.modalAdjuntoView,\n                {\n                    placement: 'center',\n                    backdrop: 'dynamic',\n                    backdropClasses: 'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',\n                    closable: true,\n                    onHide: () => {\n                        console.log('modal is hidden');\n                    },\n                    onShow: () => {\n                        console.log('modal is shown');\n                    },\n                    onToggle: () => {\n                        console.log('modal has been toggled');\n                    },\n                },\n                {\n                    id: `modal-adjunto-view-${this.workOrder?.OR}`,\n                    override: true,\n                },\n            );\n\n            document.addEventListener(PAGE_VISIT, () => {\n                console.log('modalAdjuntoView@page-visit');\n                this.modalAdjuntoView?.hide();\n            });\n        },\n\n        initModalMaterialDelete() {\n            this.modalMaterialDelete = new Modal(\n                this.$refs.modalMaterialDelete,\n                {\n                    placement: 'center',\n                    backdrop: 'dynamic',\n                    backdropClasses: 'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',\n                    closable: true,\n                    onHide: () => {\n                        console.log('modal is hidden');\n                    },\n                    onShow: () => {\n                        console.log('modal is shown');\n                    },\n                    onToggle: () => {\n                        console.log('modal has been toggled');\n                    },\n                },\n                {\n                    id: `modal-material-delete-${this.workOrder?.OR}`,\n                    override: true,\n                },\n            );\n\n            document.addEventListener(PAGE_VISIT, () => {\n                console.log('modalMaterialDelete@page-visit');\n                this.modalMaterialDelete?.hide();\n            });\n        },\n\n        initModalMaterialEdit() {\n            this.modalMaterialEdit = new Modal(\n                this.$refs.modalMaterialEdit,\n                {\n                    placement: 'center',\n                    backdrop: 'dynamic',\n                    backdropClasses: 'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',\n                    closable: true,\n                    onHide: () => {\n                        console.log('modal is hidden');\n                        this.currentWorkOrderMaterial = EmptyWorkOrderMaterial;\n                        this.$dispatch(REFERENCE_CLEAR);\n                    },\n                    onShow: () => {\n                        console.log('modal is shown');\n                    },\n                    onToggle: () => {\n                        console.log('modal has been toggled');\n                    },\n                },\n                {\n                    id: `modal-material-edit-${this.workOrder?.OR}`,\n                    override: true,\n                },\n            );\n\n            document.addEventListener(PAGE_VISIT, () => {\n                console.log('modalMaterialEdit@page-visit');\n                this.modalMaterialEdit?.hide();\n            });\n        },\n\n        initModalMaterialAdd() {\n            this.modalMaterialAdd = new Modal(\n                this.$refs.modalMaterialAdd,\n                {\n                    placement: 'center',\n                    backdrop: 'dynamic',\n                    backdropClasses: 'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',\n                    closable: true,\n                    onHide: () => {\n                        console.log('modal is hidden');\n                        this.currentWorkOrderMaterial = EmptyWorkOrderMaterial;\n                    },\n                    onShow: () => {\n                        console.log('modal is shown');\n                    },\n                    onToggle: () => {\n                        console.log('modal has been toggled');\n                    },\n                },\n                {\n                    id: `modal-material-add-${this.workOrder?.OR}`,\n                    override: true,\n                },\n            );\n\n            document.addEventListener(PAGE_VISIT, () => {\n                console.log('modalMaterialAdd@page-visit');\n                this.modalMaterialAdd?.hide();\n            });\n        },\n\n        async loadWorkOrder() {\n            try {\n                const r = await fetch(\n                    url(`/isiWeb/web/v1/empresas/01/ordenes-reparacion/${window.PineconeRouter.context.params['or']}`),\n                    {\n                        credentials: 'include',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                    },\n                );\n\n                const response = await r.json();\n\n                if (r.status === 404) {\n                    throw new Error(this.$t('WORKORDERS.or_not_found'));\n                }\n\n                this.workOrder = response.data as WorkOrder;\n            } catch (error: any) {\n                console.log(error);\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n                this.error = error.message;\n            }\n        },\n\n        async loadWorkOrderDocs() {\n            this.loadingWorkOrderDocs = true;\n            try {\n                const r = await fetch(\n                    url(\n                        `/isiWeb/web/v1/empresas/01/ordenes-reparacion/${window.PineconeRouter.context.params['or']}/documentos?blob=false`,\n                    ),\n                    {\n                        credentials: 'include',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                    },\n                );\n\n                const response = await r.json();\n\n                if (r.status === 404) {\n                    throw new Error(this.$t('WORKORDERS.or_not_found'));\n                }\n\n                this.adjuntos = response.data as Adjunto[];\n            } catch (error: any) {\n                console.log(error);\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n                this.error = error.toString();\n            }\n            this.loadingWorkOrderDocs = false;\n        },\n\n        async loadMecs() {\n            try {\n                const empresa = '01'; // TODO: multiempresa\n\n                const r = await fetch(url(`/isiWeb/web/v1/empresas/${empresa}/mecanicos`), {\n                    credentials: 'include',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                });\n\n                const response = await r.json();\n\n                if (r.status === 404) {\n                    throw new Error(this.$t('WORKORDERS.mec_not_found'));\n                }\n\n                if (!r.ok) {\n                    throw new Error(this.$t(r.statusText));\n                }\n\n                this.mecs = response.data as Mec[];\n            } catch (error: any) {\n                this.error = error.message;\n                console.log(error);\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n        },\n\n        async loadUserMec() {\n            try {\n                const r = await fetch(url(`/isiWeb/web/v1/empresas/01/mecanicos?usuario=${this.user.usuario}`), {\n                    credentials: 'include',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                });\n\n                if (r.status === 404) {\n                    throw new Error(this.$t('WORKORDERS.mec_not_found'));\n                }\n\n                if (!r.ok) {\n                    throw new Error(this.$t(r.statusText));\n                }\n\n                const response = await r.json();\n\n                this.userMec = response.data[0] as Mec;\n            } catch (error: any) {\n                this.error = error.message;\n                console.log(error);\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n        },\n\n        async loadWorkOrderMecs() {\n            this.loadingWorkOrderMecs = true;\n\n            try {\n                const r = await fetch(\n                    url(\n                        `/isiWeb/web/v1/empresas/01/ordenes-reparacion/${window.PineconeRouter.context.params['or']}/mecanicos`,\n                    ),\n                    {\n                        credentials: 'include',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                    },\n                );\n\n                const response = await r.json();\n\n                if (r.status === 404) {\n                    throw new Error(this.$t('WORKORDERS.mec_not_found'));\n                }\n\n                if (!r.ok) {\n                    throw new Error(this.$t(r.statusText));\n                }\n\n                this.workOrderMecs = response.data as WorkOrderMec[];\n            } catch (error: any) {\n                this.error = error.message;\n                console.log(error);\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n\n            this.loadingWorkOrderMecs = false;\n        },\n\n        async loadWorkOrderMaterials() {\n            this.loadingWorkOrderMaterials = true;\n\n            try {\n                const r = await fetch(url(`/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.$params.or}/lineas`), {\n                    credentials: 'include',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                });\n\n                const response = await r.json();\n\n                if (r.status === 404) {\n                    throw new Error(this.$t('WORKORDERS.material_not_found'));\n                }\n\n                if (!r.ok) {\n                    throw new Error(this.$t(r.statusText));\n                }\n\n                this.workOrderMaterials = response.data as WorkOrderMaterial[];\n            } catch (error: any) {\n                this.error = error.message;\n                console.log(error);\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n\n            this.loadingWorkOrderMaterials = false;\n        },\n\n        async addAdjunto(e: SubmitEvent) {\n            this.submitting = true;\n            this.loadingWorkOrderDocs = true;\n            const form = e.target as HTMLFormElement;\n            const data = new FormData(form);\n            const file = data.get('file') as File;\n            let adjunto = {};\n            if (file) {\n                const reader = new FileReader();\n                reader.onload = async (event) => {\n                    const dataURL = event.target?.result as string;\n                    const attachment = {\n                        or: this.workOrder?.OR,\n                        ejr: this.workOrder?.ejr,\n                        sef: this.workOrder?.sef,\n                        docum: 1,\n                        numDocum: 1,\n                        nombre: file.name,\n                        fecha: new Date().toISOString().split('T')[0],\n                        hora: new Date().toISOString().split('T')[1],\n                        descripcion: '',\n                        documento: dataURL.split(',')[1],\n                    };\n                    adjunto = attachment;\n                    try {\n                        const r = await fetch(\n                            url(`/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.$params.or}/documentos`),\n                            {\n                                method: 'POST',\n                                headers: {\n                                    'Content-Type': 'application/json',\n                                },\n                                credentials: 'include',\n                                body: JSON.stringify(adjunto),\n                            },\n                        );\n\n                        if (!r.ok) {\n                            const response = await r.json();\n                            throw new Error(this.$t(response.message));\n                        }\n\n                        const response = await r.json();\n                        this.$dispatch(TOAST_TRIGGER, { msg: response.message, level: ToastSuccess });\n                        await this.loadWorkOrderDocs();\n                    } catch (error: any) {\n                        console.log('error', error);\n                        this.$dispatch(TOAST_TRIGGER, { msg: error, level: ToastError });\n                    } finally {\n                        this.submitting = false;\n                        this.loadingWorkOrderDocs = false;\n                    }\n                };\n                reader.readAsDataURL(file);\n            }\n            this.modalAdjuntoAdd?.hide();\n        },\n\n        async saveWorkOrderReference(e: SubmitEvent) {\n            console.log('saveWorkOrderReference', e);\n            const data = new FormData(e.target as HTMLFormElement);\n            const referenceDetails = Object.fromEntries(data.entries());\n            const savedWorkOrder = {\n                ...this.workOrder,\n                refer: referenceDetails.refer,\n                numser: referenceDetails.numser,\n                reparacion: referenceDetails.reparacion,\n            } as WorkOrder;\n            this.submitting = true;\n\n            try {\n                const r = await fetch(url(`/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.$params.or}`), {\n                    method: 'PUT',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    credentials: 'include',\n                    body: JSON.stringify(savedWorkOrder),\n                });\n\n                if (!r.ok) {\n                    const response = await r.json();\n                    throw new Error(this.$t(response.message));\n                }\n\n                const response = await r.json();\n                console.log(response);\n                this.workOrder = savedWorkOrder;\n\n                this.submitting = false;\n\n                this.$dispatch(TOAST_TRIGGER, {\n                    msg: `OR-${this.$params.or} Guardada correctamente`,\n                    level: ToastSuccess,\n                });\n            } catch (error: any) {\n                this.$dispatch(TOAST_TRIGGER, { msg: error, level: ToastError });\n                console.log('error', error);\n                this.submitting = false;\n            }\n        },\n\n        async openSignModal() {\n            console.log(this.workOrder);\n            await this.loadWorkOrder();\n            await this.getIvas();\n            console.log(this.workOrderIvas);\n\n            this.modalSign?.show();\n        },\n\n        openAddAdjuntoModal() {\n            this.$refs.formAttachAdjunto?.reset();\n            this.modalAdjuntoAdd?.show();\n        },\n\n        async openViewAdjuntoModal(adjunto: Adjunto) {\n            try {\n                const objectDiv = this.$refs.modalAdjuntoViewImage as HTMLDivElement;\n                if (objectDiv.children.length > 0) {\n                    objectDiv.removeChild(objectDiv.children[0]);\n                }\n                let newModalAdjunto: HTMLImageElement | HTMLObjectElement | HTMLVideoElement;\n                if (\n                    adjunto.mimeType === 'image/jpeg' ||\n                    adjunto.mimeType === 'image/png' ||\n                    adjunto.mimeType === 'image/jpg'\n                ) {\n                    newModalAdjunto = document.createElement('img');\n                    newModalAdjunto.className = 'w-auto h-auto max-h-full';\n                    newModalAdjunto.src = await this.generateAdjuntoUrl(\n                        `/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.workOrder?.OR}/documentos/${adjunto.numDocum}/previsualiza`,\n                    );\n                    objectDiv.appendChild(newModalAdjunto);\n                }\n                if (adjunto.nombre.endsWith('.mp4') || adjunto.nombre.endsWith('.webm')) {\n                    newModalAdjunto = document.createElement('video');\n                    newModalAdjunto.width = 640;\n                    newModalAdjunto.height = 480;\n                    newModalAdjunto.controls = true;\n                    const videoSource = document.createElement('source');\n                    videoSource.src = await this.generateAdjuntoUrl(\n                        `/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.workOrder?.OR}/documentos/${adjunto.numDocum}/previsualiza`,\n                    );\n                    newModalAdjunto.appendChild(videoSource);\n                    objectDiv.appendChild(newModalAdjunto);\n                }\n                if (adjunto.mimeType === 'application/pdf') {\n                    const r = await fetch(\n                        url(\n                            `/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.workOrder?.OR}/documentos/${adjunto.numDocum}`,\n                        ),\n                        {\n                            credentials: 'include',\n                            headers: {\n                                'Content-Type': 'application/json',\n                            },\n                        },\n                    );\n                    const response = await r.json();\n                    if (!r.ok) {\n                        throw new Error(this.$t(response.message));\n                    }\n                    const adjuntoBlob = response.data as Adjunto;\n                    newModalAdjunto = document.createElement('object');\n                    newModalAdjunto.type = 'application/pdf';\n                    newModalAdjunto.className = 'w-full h-full max-h-full';\n                    newModalAdjunto.data = `data:${adjunto.mimeType};base64, ${adjuntoBlob.documento}`;\n                    const fallbackContent = document.createElement('p');\n                    const hrefFallback = document.createElement('a');\n                    hrefFallback.href = await this.generateAdjuntoUrl(\n                        `/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.workOrder?.OR}/documentos/${adjunto.numDocum}/previsualiza`,\n                    );\n                    hrefFallback.target = '_blank';\n                    hrefFallback.textContent = `${adjunto.nombre}`;\n                    hrefFallback.className = 'text-primary-600';\n                    fallbackContent.textContent = 'Visualizar ';\n                    fallbackContent.className = 'text-center';\n                    fallbackContent.appendChild(hrefFallback);\n                    newModalAdjunto.appendChild(fallbackContent);\n                    objectDiv.appendChild(newModalAdjunto);\n                }\n                this.modalAdjuntoView?.show();\n            } catch (error: any) {\n                console.log(error);\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n        },\n\n        openDeleteAdjuntoModal(adjunto: Adjunto) {\n            this.currentAdjunto = adjunto;\n            this.modalAdjuntoDelete?.show();\n        },\n\n        openAddMecModal() {\n            this.$refs.formMecAdd?.reset();\n            this.modalMecAdd?.show();\n        },\n\n        openEditMecModal(workOrderMec: WorkOrderMec) {\n            this.currentWorkOrderMec = { ...workOrderMec };\n            this.modalMecEdit?.show();\n        },\n\n        openEditMaterialModal(workOrderMaterial: WorkOrderMaterial) {\n            this.currentWorkOrderMaterial = { ...workOrderMaterial };\n            this.$dispatch(REFERENCE_GET, {\n                refer: this.currentWorkOrderMaterial.refer,\n                origin: ReferenceOriginEditMaterial,\n            });\n            this.modalMaterialEdit?.show();\n        },\n\n        openAddMaterialModal() {\n            this.$dispatch(REFERENCE_CLEAR);\n            this.modalMaterialAdd?.show();\n        },\n\n        openDeleteMecModal(workOrderMec: WorkOrderMec) {\n            this.currentWorkOrderMec = workOrderMec;\n            this.modalMecDelete?.show();\n        },\n\n        openDeleteMaterialModal(workOrderMaterial: WorkOrderMaterial) {\n            this.currentWorkOrderMaterial = workOrderMaterial;\n            this.modalMaterialDelete?.show();\n        },\n\n        async addMec(e: SubmitEvent) {\n            const data = new FormData(e.target as HTMLFormElement);\n            const newMec = Object.fromEntries(data.entries());\n            console.log('newMec', newMec);\n\n            try {\n                this.submitting = true;\n                const r = await fetch(\n                    url(`/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.$params.or}/mecanicos`),\n                    {\n                        credentials: 'include',\n                        method: 'POST',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                        body: JSON.stringify({\n                            OR: this.$params.or,\n                            intDes: newMec.intDes,\n                            fecint: newMec.fecint,\n                            horDes: +newMec.horDes,\n                            mec: +newMec.mec,\n                            kmDes: +newMec.kmDes,\n                            horTra: +newMec.horTra,\n                            facturar: newMec.facturar === 'on',\n                        } as WorkOrderMecPayload),\n                    },\n                );\n\n                if (!r.ok) {\n                    const response = await r.json();\n                    throw new Error(this.$t(response.message));\n                }\n\n                await this.loadWorkOrderMecs();\n                this.modalMecAdd?.hide();\n                this.submitting = false;\n                this.$dispatch(TOAST_TRIGGER, { msg: 'Mecánico añadido correctamente', level: ToastSuccess });\n            } catch (error: any) {\n                console.log('error', error);\n                this.submitting = false;\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n        },\n\n        async editMec(e: SubmitEvent) {\n            const data = new FormData(e.target as HTMLFormElement);\n            const editedMec = Object.fromEntries(data.entries());\n            const facturarMec = editedMec.facturar ? true : this.currentWorkOrderMec.facturar;\n\n            try {\n                this.submitting = true;\n                const r = await fetch(\n                    url(\n                        `/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.$params.or}/mecanicos/${this.currentWorkOrderMec.linea}`,\n                    ),\n                    {\n                        credentials: 'include',\n                        method: 'PUT',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                        body: JSON.stringify({\n                            OR: this.$params.or,\n                            intDes: editedMec.intDes,\n                            fecint: editedMec.fecint,\n                            horDes: +editedMec.horDes,\n                            mec: +editedMec.mec,\n                            kmDes: +editedMec.kmDes,\n                            horTra: +editedMec.horTra,\n                            facturar: facturarMec,\n                        } as WorkOrderMecPayload),\n                    },\n                );\n\n                if (!r.ok) {\n                    const response = await r.json();\n                    throw new Error(this.$t(response.message));\n                }\n                await this.loadWorkOrderMecs();\n                this.currentWorkOrderMec = null;\n                this.modalMecEdit?.hide();\n                this.submitting = false;\n                this.$dispatch(TOAST_TRIGGER, { msg: 'Mecánico editado correctamente', level: ToastSuccess });\n            } catch (error: any) {\n                this.submitting = false;\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n                console.log('error', error);\n            }\n        },\n\n        async deleteMec(workOrderMec: WorkOrderMec) {\n            try {\n                this.submitting = true;\n                const r = await fetch(\n                    url(\n                        `/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.$params.or}/mecanicos/${workOrderMec.linea}`,\n                    ),\n                    {\n                        credentials: 'include',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                        method: 'DELETE',\n                    },\n                );\n\n                if (!r.ok) {\n                    const response = await r.json();\n                    throw new Error(this.$t(response.message));\n                }\n                await this.loadWorkOrderMecs();\n                this.currentWorkOrderMec = null;\n                this.modalMecDelete?.hide();\n                this.submitting = false;\n                this.$dispatch(TOAST_TRIGGER, { msg: 'Mecánico eliminado correctamente', level: ToastSuccess });\n            } catch (error: any) {\n                console.log('error', error);\n                this.submitting = false;\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n        },\n\n        async addMaterial() {\n            try {\n                this.submitting = true;\n                if (this.currentWorkOrderMaterial.canped <= 0) {\n                    throw new Error(this.$t('WORKORDERS.min_quantity_gt_zero'));\n                }\n                const r = await fetch(url(`/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.$params.or}/lineas`), {\n                    credentials: 'include',\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify(this.currentWorkOrderMaterial),\n                });\n\n                if (!r.ok) {\n                    const response = await r.json();\n                    throw new Error(this.$t(response.message));\n                }\n                await this.loadWorkOrderMaterials();\n                this.currentWorkOrderMaterial = {\n                    OR: this.$params.or,\n                    artde1: '',\n                    canped: 1,\n                    dtvdto: 0,\n                    dtvdto2: 0,\n                    dtvdto3: 0,\n                    implnet: 0,\n                    iva: '',\n                    precioCero: false,\n                    pvp1: 0,\n                    refer: '',\n                };\n                this.submitting = false;\n                this.$dispatch(REFERENCE_CLEAR);\n                this.$dispatch(TOAST_TRIGGER, { msg: 'Material añadido correctamente', level: ToastSuccess });\n                this.modalMaterialAdd?.hide();\n            } catch (error: any) {\n                console.log('error', error);\n                this.submitting = false;\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n        },\n\n        async editMaterial(e: SubmitEvent) {\n            const data = new FormData(e.target as HTMLFormElement);\n            const editedMaterial = Object.fromEntries(data.entries());\n            console.log('currentWorkOrderMaterial', this.currentWorkOrderMaterial);\n\n            try {\n                this.submitting = true;\n                const r = await fetch(\n                    url(\n                        `/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.$params.or}/lineas/${this.currentWorkOrderMaterial.linea}`,\n                    ),\n                    {\n                        credentials: 'include',\n                        method: 'PUT',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                        body: JSON.stringify({\n                            OR: this.$params.or,\n                            artde1: editedMaterial.artde1,\n                            canped: +editedMaterial.canped,\n                            refer: editedMaterial.refer,\n                            pvp1: this.currentWorkOrderMaterial.pvp1,\n                            implnet: this.currentWorkOrderMaterial.implnet,\n                            iva: this.currentWorkOrderMaterial.iva,\n                            dtvdto: this.currentWorkOrderMaterial.dtvdto,\n                            dtvdto2: this.currentWorkOrderMaterial.dtvdto2,\n                            dtvdto3: this.currentWorkOrderMaterial.dtvdto3,\n                            precioCero: this.currentWorkOrderMaterial.precioCero,\n                        } as WorkOrderMaterial),\n                    },\n                );\n\n                if (!r.ok) {\n                    const response = await r.json();\n                    throw new Error(this.$t(response.message));\n                }\n\n                await this.loadWorkOrderMaterials();\n                this.currentWorkOrderMaterial = EmptyWorkOrderMaterial;\n                this.modalMaterialEdit?.hide();\n                this.submitting = false;\n                this.$dispatch(REFERENCE_CLEAR);\n                this.$dispatch(TOAST_TRIGGER, { msg: 'Material editado correctamente', level: ToastSuccess });\n            } catch (error: any) {\n                console.log('error', error);\n                this.submitting = false;\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n        },\n\n        async deleteMaterial(workOrderMaterial: WorkOrderMaterial) {\n            try {\n                this.submitting = true;\n                const r = await fetch(\n                    url(\n                        `/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.$params.or}/lineas/${workOrderMaterial.linea}`,\n                    ),\n                    {\n                        credentials: 'include',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                        method: 'DELETE',\n                    },\n                );\n\n                if (!r.ok) {\n                    const response = await r.json();\n                    throw new Error(this.$t(response.message));\n                }\n\n                await this.loadWorkOrderMaterials();\n                this.currentWorkOrderMaterial = EmptyWorkOrderMaterial;\n\n                this.modalMaterialDelete?.hide();\n                this.submitting = false;\n                this.$dispatch(TOAST_TRIGGER, { msg: 'Material eliminado correctamente', level: ToastSuccess });\n            } catch (error: any) {\n                console.log('error', error);\n                this.submitting = false;\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n        },\n\n        async deleteAdjunto(adjunto: Adjunto) {\n            try {\n                this.submitting = true;\n\n                const r = await fetch(\n                    url(\n                        `/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.$params.or}/documentos/${adjunto.numDocum}`,\n                    ),\n                    {\n                        credentials: 'include',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                        method: 'DELETE',\n                    },\n                );\n\n                if (!r.ok) {\n                    const response = await r.json();\n                    throw new Error(this.$t(response.message));\n                }\n                const response = await r.json();\n                await this.loadWorkOrderDocs();\n                this.modalAdjuntoDelete?.hide();\n                this.submitting = false;\n                this.$dispatch(TOAST_TRIGGER, { msg: response.message, level: ToastSuccess });\n            } catch (error: any) {\n                console.log('error', error);\n                this.submitting = false;\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n        },\n\n        async getIvas() {\n            try {\n                const r = await fetch(\n                    url(\n                        `/isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.$params.or}/ivas?almnro=${this.workOrder?.almnro}`,\n                    ),\n                    {\n                        credentials: 'include',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                    },\n                );\n\n                if (!r.ok) {\n                    const response = await r.json();\n                    throw new Error(this.$t(response.message));\n                }\n\n                const response = await r.json();\n                this.workOrderIvas =\n                    response.data.length > 0 ? (response.data[0] as WorkOrderIvas) : EmptyWorkOrderIvas;\n            } catch (error: any) {\n                console.log('error', error);\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n        },\n\n        tipRepValue(): string {\n            const workOrder = this.workOrder as WorkOrder | null;\n            return workOrder?.tiprep ? WorkOrderTipRepMap[workOrder.tiprep] : '';\n        },\n\n        async generateAdjuntoUrl(uri: string): Promise<string> {\n            return url(uri);\n        },\n\n        async finalizeWorkOrder() {\n            const signatures = [this.clientSignature, this.mecSignature];\n            try {\n                for (let i = 0; i < signatures.length; i++) {\n                    const r = await fetch(\n                        url(`isiWeb/web/v1/empresas/01/ordenes-reparacion/${this.$params.or}/firma`),\n                        {\n                            credentials: 'include',\n                            method: 'POST',\n                            headers: {\n                                'Content-Type': 'application/json',\n                            },\n                            body: JSON.stringify({\n                                origen: i === 0 ? 'firmaCliente' : 'firmaMecanico',\n                                adjunto: signatures[i].substring(signatures[i].indexOf(',') + 1),\n                            }),\n                        },\n                    );\n\n                    if (!r.ok) {\n                        const response = await r.json();\n                        throw new Error(this.$t(response.message));\n                    }\n                    this.$dispatch(TOAST_TRIGGER, {\n                        msg: `OR-${this.$params.or} finalizada correctamente`,\n                        level: ToastSuccess,\n                    });\n                }\n\n                this.modalSign?.hide();\n\n                this.$router.navigate('/or/list');\n                // TODO: hablar con Antonia sobre como sigue el flow\n            } catch (error: any) {\n                console.log('error', error);\n                this.$dispatch(TOAST_TRIGGER, { msg: this.$t(error.toString()), level: ToastError });\n            }\n        },\n    }),\n} as ComponentModule;\n"],"file":"assets/work-order-edit-DgAQX4aj.js"}